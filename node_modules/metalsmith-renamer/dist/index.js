var minimatch = require('minimatch');
var path = require('path');

const renamer = options => {
  return (files, _, done) => {
    Object.keys(options).map(opt => {
      const matcher = minimatch.Minimatch(options[opt].pattern);
      Object.keys(files).map(file => {
        if (!matcher.match(file)) {
          return;
        }

        const nameTransformer = options[opt].rename;
        let newFilename = path.dirname(file); // If file is at root of the `source` directory, strip the relative file path

        if (newFilename === ".") {
          newFilename = "";
        }

        if (typeof nameTransformer === "function") {
          newFilename = path.join(newFilename, nameTransformer(path.basename(file)));
        } else {
          newFilename = path.join(newFilename, nameTransformer);
        }

        if (newFilename !== file) {
          files[newFilename] = files[file];
          delete files[file];
        }
      });
    });
    done();
  };
};

module.exports = renamer;
//# sourceMappingURL=index.js.map
